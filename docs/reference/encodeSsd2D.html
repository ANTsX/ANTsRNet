<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Encoding function for 2-D Y_train — encodeSsd2D • ANTsRNet</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Encoding function for 2-D Y_train — encodeSsd2D" />
<meta property="og:description" content="Function for translating the min/max ground truth box coordinates to
something expected by the SSD network.  This is a SSD-specific analog
for keras::to_categorical().  For each image in the batch, we compare
the ground truth boxes for that image with all the anchor boxes.  If
the overlap measure exceeds a specific threshold, we write the ground
truth box coordinates and class to the specific position of the matched
anchor box.  Note that the background class will be assigned to all the
anchor boxes for which there was no match with any ground truth box.
However, an exception to this are the anchor boxes whose overlap measure
is higher that the specified negative threshold." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANTsRNet</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ANTsX/ANTsRNet/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Encoding function for 2-D Y_train</h1>
    <small class="dont-index">Source: <a href='https://github.com/ANTsX/ANTsRNet/blob/master/R/ssdUtilities.R'><code>R/ssdUtilities.R</code></a></small>
    <div class="hidden name"><code>encodeSsd2D.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function for translating the min/max ground truth box coordinates to
something expected by the SSD network.  This is a SSD-specific analog
for keras::to_categorical().  For each image in the batch, we compare
the ground truth boxes for that image with all the anchor boxes.  If
the overlap measure exceeds a specific threshold, we write the ground
truth box coordinates and class to the specific position of the matched
anchor box.  Note that the background class will be assigned to all the
anchor boxes for which there was no match with any ground truth box.
However, an exception to this are the anchor boxes whose overlap measure
is higher that the specified negative threshold.</p>
    </div>

    <pre class="usage"><span class='fu'>encodeSsd2D</span>(
  <span class='no'>groundTruthLabels</span>,
  <span class='no'>anchorBoxes</span>,
  <span class='no'>imageSize</span>,
  <span class='kw'>variances</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>4</span>),
  <span class='kw'>foregroundThreshold</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
  <span class='kw'>backgroundThreshold</span> <span class='kw'>=</span> <span class='fl'>0.2</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>groundTruthLabels</th>
      <td><p>A list of length <code>batchSize</code> that contains one
2-D array per image.  Each 2-D array has k rows where each row corresponds
to a single box consisting of the format (classId,xmin,xmax,ymin,ymax).
Note that <code>classId</code> must be greater than 0 since 0 is reserved for the
background label.</p></td>
    </tr>
    <tr>
      <th>anchorBoxes</th>
      <td><p>a list of 2-D arrays where each element comprises the
anchor boxes for a specific aspect ratios layer.  The row of each 2-D array
comprises a single box specified in the form (xmin,xmax,ymin,ymax).</p></td>
    </tr>
    <tr>
      <th>imageSize</th>
      <td><p>2-D vector specifying the spatial domain of the input
images.</p></td>
    </tr>
    <tr>
      <th>variances</th>
      <td><p>A list of 4 floats &gt; 0 with scaling factors (actually it's
not factors but divisors to be precise) for the encoded predicted box
coordinates. A variance value of 1.0 would apply no scaling at all to the
predictions, while values in <code>(0, 1)</code> upscale the encoded predictions and
values greater than 1.0 downscale the encoded predictions. These are the same
variances used to construct the model. Default = <code><a href='https://rdrr.io/r/base/c.html'>c( 1.0, 1.0, 1.0, 1.0 )</a></code></p></td>
    </tr>
    <tr>
      <th>foregroundThreshold</th>
      <td><p>float between 0 and 1 determining the min threshold
for matching an anchor box with a ground truth box and, thus, labeling an anchor
box as a non-background class.  If an anchor box exceeds the <code>backgroundThreshold</code>
but does not meet the foregroundThreshold for a ground truth box, then it is ignored
during training.  Default = 0.5.</p></td>
    </tr>
    <tr>
      <th>backgroundThreshold</th>
      <td><p>float between 0 and 1 determining the max threshold
for labeling an anchor box as <code>background</code>.  If an anchor box exceeds the
<code>backgroundThreshold</code> but does not meet the foregroundThreshold for a ground
truth box, then it is ignored during training.  Default = 0.2.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a 3-D array of shape (<code>batchSize</code>, <code>numberOfBoxes</code>,
<code>numberOfClasses</code> + 4 + 4 + 4)</p>
<p>where the additional 4's along the third dimension correspond to
the 4 predicted box coordinate offsets, the 4 coordinates for
the anchor boxes, and the 4 variance values.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This particular implementation was heavily influenced by the following
python and R implementations:</p><pre>    \url{https://github.com/pierluigiferrari/ssd_keras}
    \url{https://github.com/rykov8/ssd_keras}
    \url{https://github.com/gsimchoni/ssdkeras}
</pre>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nicholas J Tustison, Brian B Avants.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


